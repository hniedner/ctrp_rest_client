{%- extends "base.html" %}

{% block title %}
Clinical Trial Search Results
{% endblock %}

{% block styles %}
{{super()}}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.13/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.2.4/css/buttons.bootstrap.min.css">
{% endblock %}

{% block scripts %}
{{super()}}
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.13/js/dataTables.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.4/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.4/js/buttons.bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
    <script src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/pdfmake.min.js"></script>
    <script src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.4/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.4/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.2.4/js/buttons.colVis.min.js"></script>

<script>
        $(document).ready(function() {
            var table = $('#datatable').DataTable( {
                ajax: "{{ url_for('_get_data') }}",

                columns: [
                    { "data": "nci_id",
                        "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
                            $(nTd).html("<a href='/display_trial/" + oData.nci_id + "'>" + oData.nci_id + "</a>");
                        }
                    },

                    { "data": "nct_id",
                        "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
                            $(nTd).html("<a href='/display_trial/" + oData.nct_id + "'>" + oData.nct_id + "</a>");
                        }
                    },
                    { "data": "phase.phase" },
                    { "data": "start_date" },
                    { "data": "current_trial_status" },
                    { "data": "official_title" }
                ],

                buttons: [
                    'copyHtml5',
                    'excelHtml5',
                    'csvHtml5',
                    'pdfHtml5'
                ],
                nowrap: true,
                bJQueryUI: true,
                lengthMenu: [ [10, 25, 50, -1], [10, 25, 50, "All"] ],
                sDom: 'Bflpitipr',
                bStateSave: true,
                initComplete: function( settings, json ) {
                    table.buttons().container()
                    .appendTo( '#datatable_wrapper .col-sm-6:eq(0)' );
                }
            } );
        } );


</script>
{% endblock %}

{% block content %}
<div class="container">
    <table id="datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
        <tr>
            <th>NCI ID</th>
            <th>NCT ID</th>
            <th>Phase</th>
            <th>Start Date</th>
            <th>Current Status</th>
            <th>Official Title</th>
        </tr>
        </thead>
        <tfoot>
        <tr>
            <th>NCI ID</th>
            <th>NCT ID</th>
            <th>Phase</th>
            <th>Start Date</th>
            <th>Current Status</th>
            <th>Official Title</th>
        </tr>
        </tfoot>
        <tbody>
        </tbody>
    </table>
</div>
{% endblock %}